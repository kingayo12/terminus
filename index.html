<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Terminus Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v7.1.0/css/all.css">
    <link rel="stylesheet" href="./assets/css/style.css">

    <style>
        /* OTP input styles */
        .otp-box {
            width: 3rem;
            height: 3rem;
            text-align: center;
            font-size: 1.5rem;
            border: 2px solid #cbd5e1;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            outline: none;
            background-color: white;
        }

        .otp-box:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
            transform: scale(1.05);
        }

        #twoFABox {
            width: 100%;
            animation-duration: 0.6s;
        }
    </style>
</head>

<body class="bg-gradient h-screen w-screen overflow-hidden">

    <!-- INTRO SECTION -->
    <div id="introContainer" class="h-full w-full relative">
        <nav style="z-index: 8; backdrop-filter: blur(50px);"
            class="bg-white mt-2 rounded-md p-2 h-14 w-[98.5%] flex items-center shadow-md absolute top-0 left-2">
            <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 h-full flex items-center">
                <img src="./assets/imgs/logo/logo.png" alt="Terminus Logo" loading="lazy" class="h-8" />
            </div>
        </nav>

        <div id="slides" class="h-full w-full relative">
            <!-- Slide 1 -->
            <div
                class="slide h-full w-full flex flex-col items-center text-center justify-center text-gray-800 animate__animated animate__fadeIn px-6 md:px-16 relative">
                <img src="./assets/imgs/bg/ik.jpg" alt="Background pattern" loading="lazy"
                    class="absolute inset-0 w-full h-full object-cover opacity-10" style="z-index: -1;" />
                <h2 class="text-3xl md:text-4xl font-bold text-[#0349d7] mb-3">
                    TOS
                </h2>
                <p class="max-w-md text-black text-sm md:text-lg mb-4 text-center">
                    Simplify your terminal operations with precision, speed, and reliability.
                    From invoicing and container tracking to barge entries and performance
                    reports—all in one place.
                </p>
            </div>

            <!-- Slide 2 -->
            <div
                class="slide h-full w-full hidden flex flex-col items-center justify-center text-center text-gray-800 animate__animated animate__fadeIn">
                <img src="./assets/imgs/bg/ik.jpg" alt="Background pattern" loading="lazy"
                    class="absolute inset-0 w-full h-full object-cover opacity-10" style="z-index: -1;" />
                <h2 class="text-4xl font-bold text-[#0349d7] mb-3">Real-time Insights</h2>
                <p class="max-w-md text-gray-600 text-lg">Monitor container movements, schedules, and reports — all in
                    real time.</p>
            </div>

            <!-- Slide 3 -->
            <div
                class="slide h-full w-full hidden flex flex-col items-center justify-center text-center text-gray-800 animate__animated animate__fadeIn">
                <img src="./assets/imgs/bg/ik.jpg" alt="Background pattern" loading="lazy"
                    class="absolute inset-0 w-full h-full object-cover opacity-10" style="z-index: -1;" />
                <h2 class="text-4xl font-bold text-[#0349d7] mb-3">Secure & Reliable</h2>
                <p class="max-w-md text-gray-600 text-lg">Experience enterprise-grade protection for your terminal
                    operations data.</p>
            </div>
        </div>

        <!-- Buttons bottom-right -->
        <div class="absolute bottom-10 right-10 flex items-center space-x-4">
            <button id="prevBtn"
                class="hidden bg-white text-black px-5 py-1 rounded-lg shadow hover:bg-black hover:text-white hover:ring-2 ring-white transition">Prev</button>
            <button id="nextBtn"
                class="bg-white text-black px-5 py-1 rounded-lg shadow hover:bg-black hover:text-white hover:ring-2 ring-white transition">Next</button>
            <button id="skipBtn"
                class="bg-black text-white px-5 py-1 rounded-lg shadow hover:text-white ring-2 ring-white transition">Skip
                Intro</button>
        </div>
    </div>

    <!-- LOGIN SECTION -->
    <div id="loginContainer"
        class="hidden h-full min-h-full w-full flex flex-col items-center justify-center animate__animated animate__fadeIn">
        <div class="w-full h-full bg-white shadow-md overflow-hidden flex flex-col md:flex-row">
            <!-- LEFT SIDE -->
            <div class="relative overflow-y-auto w-full md:w-1/2 flex flex-col justify-between px-10 py-12 space-y-4">

                <div class="flex flex-row justify-between">
                    <img src="./assets/imgs/logo/logo.png" alt="Terminus Logo" loading="lazy" class="w-full max-w-48">
                    <div class="version text-indigo-200 text-[10px]">V 7.1.2</div>
                </div>

                <div class="two_hidden max-w-4xl w-full flex flex-col m-auto text-center">
                    <h1
                        class="text-2xl font-semibold text-gray-900 relative text-center flex align-center justify-center text-center w-full">
                        Sign In

                    </h1>
                    <p class="text-gray-500 mt-1 text-sm">
                        Log in to manage your container terminal operations with Terminus.
                    </p>
                </div>

                <form class="two_hidden space-y-4 w-full max-w-md m-auto text-sm">
                    <!-- Username -->
                    <div>
                        <label for="username" class="block text-gray-700 font-medium text-xs mb-1">Username</label>
                        <div class="relative mt-1">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs">
                                <i class="fa-solid fa-user"></i>
                            </span>
                            <input id="username" type="text" placeholder="Enter your username"
                                class="w-full text-sm pl-8 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none" />
                        </div>
                    </div>

                    <!-- Facility -->
                    <div>
                        <label for="facility" class="block text-gray-700 font-medium text-xs mb-1">Facility</label>
                        <div class="relative mt-1">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs">
                                <i class="fa-solid fa-building"></i>
                            </span>
                            <select id="facility"
                                class="w-full text-sm pl-8 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                <option value="">Select Facility</option>
                                <option value="mainland">Mainland Terminal</option>
                                <option value="seaview">Seaview Terminal</option>
                                <option value="apapa">Apapa Terminal</option>
                            </select>
                        </div>
                    </div>

                    <!-- Password -->
                    <div>
                        <label class="text-xs font-medium text-gray-700">Password</label>
                        <div class="relative mt-1">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs">
                                <i class="fa-solid fa-lock"></i>
                            </span>
                            <input type="password" placeholder="••••••••"
                                class="w-full text-sm pl-8 pr-8 border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                                id="passwordInput" />
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer text-xs"
                                id="togglePassword">
                                <i class="fa-solid fa-eye"></i>
                            </span>
                        </div>
                    </div>

                    <!-- Remember & Forgot -->
                    <div class="flex items-center justify-between text-xs mt-2">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" id="rememberMe" class="rounded text-indigo-600 w-3 h-3" />
                            <span>Remember Me</span>
                        </label>
                        <a href="forgotpassword.html" class="text-indigo-600 hover:underline">Forgot Password?</a>
                    </div>

                    <!-- Login Button -->
                    <button type="submit"
                        class="w-full py-2 text-sm bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 transition">
                        Sign In
                    </button>

                    <!-- Social Login -->
                    <div class="flex flex-row space-x-4 w-32 m-auto align-center justify-center">
                        <div class="liner mt-2 text-indigo-200">Or</div>
                        <button id="googleLoginBtn" type="button"
                            class="flex-1 border border-gray-300 py-2 rounded-lg hover:border-[#0349d7] hover:text-[#0349d7] transition">
                            <i class="fa-brands fa-google"></i>
                        </button>

                        <button type="button"
                            class="flex-1 border border-gray-300 py-2 rounded-lg hover:border-[#0349d7] hover:text-[#0349d7] transition">
                            <i class="fa-brands fa-apple"></i>
                        </button>
                    </div>

                    <!-- Register -->
                    <p class="text-sm text-center text-gray-600 mt-2">
                        Don’t Have An Account?
                        <a href="register.html" class="text-[#0349d7] font-medium hover:underline">Register Now.</a>
                    </p>
                </form>
                <div class="text-left float-left  w-full  flex justify-center items-center">
                    <button id="replayIntroBtn"
                        class="text-[8px] text-blue-600 hover:bg-blue-200/10 rounded-full px-2 py-1 -m-14">
                        Replay Intro <i class="fa fa-play"></i>
                    </button>
                </div>

                <!-- 2FA SECTION (inside login container) -->
                <div id="twoFABox"
                    class="hidden animate__animated animate__fadeIn flex flex-col items-center justify-center px-8 py-10 text-center">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-4">Two-Factor Authentication</h2>
                    <p class="text-sm text-gray-600 mb-8">
                        Enter the 6-digit verification code sent to your registered email or phone number.
                    </p>

                    <!-- OTP Boxes -->
                    <div id="otpInputs" class="flex justify-between gap-3 mb-8">
                        <input type="text" maxlength="1" class="otp-box" />
                        <input type="text" maxlength="1" class="otp-box" />
                        <input type="text" maxlength="1" class="otp-box" />
                        <input type="text" maxlength="1" class="otp-box" />
                        <input type="text" maxlength="1" class="otp-box" />
                        <input type="text" maxlength="1" class="otp-box" />
                    </div>

                    <button id="verify2FABtn"
                        class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition">Verify</button>

                    <p id="twoFAError" class="text-red-600 text-xs mt-3 hidden">Invalid code. Please try again.</p>

                    <p class="text-sm text-gray-500 mt-6">
                        Didn’t receive a code?
                        <button id="resendCode" class="text-blue-600 hover:underline text-sm">Resend</button>
                    </p>
                </div>

                <footer class="text-center text-[10px] text-gray-400 mt-1">
                    © 2025 Terminus Enterprises LTD. |
                    <a href="#" class="text-[#0349d7] hover:underline">Privacy Policy</a>
                </footer>
            </div>

            <!-- Privacy Policy Modal -->
            <div id="privacyModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
                <div
                    class="bg-white rounded-lg w-11/12 max-w-xl p-6 relative shadow-lg animate__animated animate__fadeInDown">
                    <!-- Close button -->
                    <button id="closePrivacy" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800">
                        <i class="fa-solid fa-xmark"></i>
                    </button>

                    <h2 class="text-xl font-semibold mb-4">Privacy Policy</h2>
                    <div class="text-sm text-gray-700 max-h-96 overflow-y-auto space-y-2">
                        <p>
                            Welcome to Terminus Enterprises LTD. Your privacy is important to us. We collect and use
                            your data
                            to provide and improve our services. By using our services, you consent to the collection
                            and use of
                            information in accordance with this policy.
                        </p>
                        <p>
                            We do not sell or share your personal data with third parties except as required by law or
                            to
                            provide the services you requested. You can review or request deletion of your data at any
                            time by
                            contacting our support team.
                        </p>
                        <p>
                            This privacy policy may be updated from time to time. Please check this modal periodically
                            to
                            stay informed of any changes.
                        </p>
                    </div>
                </div>
            </div>


            <!-- RIGHT SIDE -->
            <div
                class="w-full md:w-1/2 bg-[#0349d7] text-white flex flex-col justify-center items-center p-10 relative overflow-hidden hidden md:flex">
                <img loading="lazy" src="./assets/imgs/bg/bg1.png" alt="Background pattern"
                    class="absolute inset-0 w-full h-full object-cover opacity-10 moving-bg" style="z-index: 1;" />
                <div class="two_hidden max-w-sm" style="z-index: 2;">
                    <h2 class="text-xl font-semibold mb-2">
                        Simplify your terminal operations with Terminus.
                    </h2>
                    <p class="text-indigo-200 text-xs mb-6">
                        Terminus helps container terminals manage daily operations — from invoicing and rating to barge
                        entries, container tracking, and performance reporting — all in one seamless system.
                    </p>
                    <div class="w-full h-50 overflow-hidden relative">
                        <div id="slider" class="flex transition-transform duration-700 ease-in-out">
                            <img src="./assets/imgs/login/dashboard.png" alt="Dashboard preview 1" loading="lazy"
                                class="w-full object-cover shadow-lg flex-shrink-0" />
                            <img src="./assets/imgs/login/dashboard2.gif" alt="Dashboard preview 2" loading="lazy"
                                class="w-full object-contain shadow-lg flex-shrink-0" />
                            <img src="./assets/imgs/login/dashboard3.gif" alt="Dashboard preview 3" loading="lazy"
                                class="w-full object-cover rounded-lg shadow-lg flex-shrink-0" />
                        </div>
                    </div>
                </div>

                <div class="absolute inset-0 bg-indigo-700/30 backdrop-blur-sm" style="z-index: -1"></div>
            </div>
        </div>
    </div>

    <!-- 2FA SECTION -->
    <!-- 2FA SECTION -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        const slides = document.querySelectorAll(".slide");
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");
        const skipBtn = document.getElementById("skipBtn");
        const introContainer = document.getElementById("introContainer");
        const loginContainer = document.getElementById("loginContainer");
        let currentSlide = 0;

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.add("hidden");
                if (i === index) {
                    slide.classList.remove("hidden");
                    slide.classList.add("animate__fadeIn");
                }
            });
            prevBtn.classList.toggle("hidden", index === 0);
            nextBtn.textContent = index === slides.length - 1 ? "Finish" : "Next";
        }

        nextBtn.addEventListener("click", () => {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                showSlide(currentSlide);
            } else {
                localStorage.setItem("introSeen", "true");
                transitionToLogin();
            }
        });

        prevBtn.addEventListener("click", () => {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        });

        skipBtn.addEventListener("click", () => {
            transitionToLogin();
        });

        function transitionToLogin() {
            introContainer.classList.add("animate__fadeOutUp");
            setTimeout(() => {
                introContainer.classList.add("hidden");
                loginContainer.classList.remove("hidden");
                loginContainer.classList.add("animate__fadeInDown");
            }, 600);
        }

        if (localStorage.getItem("introSeen") === "true") {
            introContainer.classList.add("hidden");
            loginContainer.classList.remove("hidden");
        } else {
            showSlide(currentSlide);
        }

        const togglePassword = document.getElementById("togglePassword");
        const passwordInput = document.getElementById("passwordInput");
        togglePassword.addEventListener("click", () => {
            const type = passwordInput.getAttribute("type") === "password" ? "text" : "password";
            passwordInput.setAttribute("type", type);
            togglePassword.innerHTML = type === "password"
                ? '<i class="fa-solid fa-eye"></i>'
                : '<i class="fa-solid fa-eye-slash"></i>';
        });

        const slider = document.getElementById("slider");
        let index = 0;
        setInterval(() => {
            index = (index + 1) % slider.children.length;
            slider.style.transform = `translateX(-${index * 100}%)`;
        }, 8000);

        const loginForm = document.querySelector("form");
        loginForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const username = document.getElementById("username").value.trim();
            const facility = document.getElementById("facility").value.trim();
            const password = document.getElementById("passwordInput").value.trim();

            const validUsers = [
                { username: "admin", password: "1234", facility: "mainland" },
                { username: "operator", password: "1234", facility: "apapa" },
            ];

            const matchedUser = validUsers.find(
                (user) =>
                    user.username === username &&
                    user.password === password &&
                    user.facility === facility
            );

            const loginButton = loginForm.querySelector("button[type='submit']");

            if (!username || !facility || !password) {
                showError("Please fill in all fields.");
                return;
            }

            if (matchedUser) {
                loginButton.textContent = "Logging in...";
                loginButton.disabled = true;
                loginButton.classList.add("opacity-70");

                setTimeout(() => {
                    handleLoginSuccess(matchedUser);
                }, 1000);
            } else {
                showError("Invalid credentials. Please try again.");
            }
        });

        function showError(message) {
            let errorBox = document.querySelector("#loginError");
            if (!errorBox) {
                errorBox = document.createElement("div");
                errorBox.id = "loginError";
                errorBox.className =
                    "absolute top bg-red-600/10 p-2 right-[38%] top-2 mt-2 rounded-md text-red-600 text-xs mt-2 animate__animated animate__fadeIn";
                loginForm.appendChild(errorBox);
            }
            errorBox.textContent = message;
        }

        document.getElementById("replayIntroBtn").addEventListener("click", () => {
            localStorage.removeItem("introSeen");
            location.reload();
        });

        // ================= 2FA AUTHENTICATION (INLINE) =================
        const twoFABox = document.getElementById("twoFABox");
        const verify2FABtn = document.getElementById("verify2FABtn");
        const twoFAError = document.getElementById("twoFAError");
        const resendCodeBtn = document.getElementById("resendCode");
        const otpInputs = document.querySelectorAll(".otp-box");
        const twoHidden = document.querySelectorAll(".two_hidden");

        let generated2FACode = null;
        let currentUser = null;

        function handleLoginSuccess(user) {
            currentUser = user;
            generated2FACode = generate2FACode();
            console.log("2FA code:", generated2FACode);
            alert(`Your 2FA code is: ${generated2FACode}`); // simulate sending

            // hide login form, show 2FA form inside same box
            // document.getElementById("loginForm").classList.add("hidden");
            twoHidden.forEach(el => el.classList.add("hidden"));
            twoFABox.classList.remove("hidden");
            otpInputs[0].focus();
        }

        function generate2FACode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        // OTP input auto-jump and backspace
        otpInputs.forEach((input, index) => {
            input.addEventListener("input", (e) => {
                const value = e.target.value.replace(/\D/g, "");
                e.target.value = value;
                if (value && index < otpInputs.length - 1) otpInputs[index + 1].focus();
            });

            input.addEventListener("keydown", (e) => {
                if (e.key === "Backspace" && !e.target.value && index > 0) {
                    otpInputs[index - 1].focus();
                }
            });
        });

        // Verify entered code
        verify2FABtn.addEventListener("click", () => {
            const enteredCode = Array.from(otpInputs)
                .map((input) => input.value)
                .join("");

            if (enteredCode.length < 6) {
                twoFAError.textContent = "Please enter all 6 digits.";
                twoFAError.classList.remove("hidden");
                return;
            }

            if (enteredCode === generated2FACode) {
                verify2FABtn.textContent = "Verifying...";
                verify2FABtn.disabled = true;

                setTimeout(() => {
                    alert("2FA verification successful!");
                    window.location.href = "dashboard.html";
                }, 1000);
            } else {
                twoFAError.classList.remove("hidden");
                twoFAError.textContent = "Invalid code. Please try again.";
                twoFAError.classList.add("animate__shakeX");
                setTimeout(() => twoFAError.classList.remove("animate__shakeX"), 800);
                otpInputs.forEach((input) => (input.value = ""));
                otpInputs[0].focus();
            }
        });

        // Resend new code
        resendCodeBtn.addEventListener("click", () => {
            generated2FACode = generate2FACode();
            console.log("New 2FA code:", generated2FACode);
            alert(`A new 2FA code has been sent: ${generated2FACode}`);
        });


        function handleGoogleLogin(response) {
            // Google returns a JWT
            const jwt = response.credential;

            // Decode the JWT payload
            const payload = JSON.parse(atob(jwt.split('.')[1]));

            console.log("Google User:", payload);

            // Create a mock user object that matches your existing login system
            const googleUser = {
                username: payload.email,
                facility: "google_oauth",
                password: null,
                name: payload.name
            };

            // Go straight to 2FA just like a normal login
            handleLoginSuccess(googleUser);
        }

        window.onload = function () {
            google.accounts.id.initialize({
                client_id: "99436185601-lnfp6u8945cl8rkbqln0v1qlh2hucipa.apps.googleusercontent.com",
                callback: handleGoogleLogin,
                auto_select: false,
                ux_mode: "popup"
            });

            document.getElementById("googleLoginBtn").addEventListener("click", () => {
                google.accounts.id.prompt(); // open Google popup
            });
        };


        const privacyLink = document.querySelector("footer a"); // selects your Privacy Policy link
        const privacyModal = document.getElementById("privacyModal");
        const closePrivacy = document.getElementById("closePrivacy");

        privacyLink.addEventListener("click", (e) => {
            e.preventDefault();
            privacyModal.classList.remove("hidden");
            privacyModal.classList.add("flex");
        });

        closePrivacy.addEventListener("click", () => {
            privacyModal.classList.add("hidden");
            privacyModal.classList.remove("flex");
        });

        // Close modal when clicking outside the modal content
        privacyModal.addEventListener("click", (e) => {
            if (e.target === privacyModal) {
                privacyModal.classList.add("hidden");
                privacyModal.classList.remove("flex");
            }
        });


    </script>
</body>

</html>